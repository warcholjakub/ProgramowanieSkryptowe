<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: console_script2.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: console_script2.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import fs from "fs-extra";
import { argv } from "node:process";
import { exec } from "node:child_process"
import * as readline from "readline";

/**
 * Wczytuje asynchronicznie wartość cnt z pliku oraz inkrementuje ją o 1.
 * @author Jakub Warchoł &lt;jakubwarchol@student.agh.edu.pl>
 */

function async_counter() {
  fs.readFile(
    "/home/jwarchol/ProgramowanieSkryptowe/lab10/src/counter",
    "utf-8",
    function (err, data) {
      let cnt = Number(data) + 1;
      if (isNaN(cnt)) {
        cnt = 1;
      }
      console.log(`Liczba uruchomień: ${cnt}`);
      fs.writeFile(
        "/home/jwarchol/ProgramowanieSkryptowe/lab10/src/counter",
        `${cnt}`
      );
    }
  );
}

/**
 * Wczytuje synchronicznie wartość cnt z pliku oraz inkrementuje ją o 1.
 * @author Jakub Warchoł &lt;jakubwarchol@student.agh.edu.pl>
 */

function sync_counter() {
  let cnt;
  cnt =
    Number(
      fs.readFileSync("/home/jwarchol/ProgramowanieSkryptowe/lab10/src/counter")
    ) + 1;
  if (isNaN(cnt)) {
    cnt = 1;
  }
  console.log(`Liczba uruchomień: ${cnt}`);
  fs.writeFileSync(
    "/home/jwarchol/ProgramowanieSkryptowe/lab10/src/counter",
    `${cnt}`
  );
}

/**
 * Pozwala obsługiwać linię komend terminala z programu JS.
 * @author Jakub Warchoł &lt;jakubwarchol@student.agh.edu.pl>
 */

function sys_cmd(){
    return new Promise(function() {
        let rl = readline.createInterface(process.stdin, process.stdout)
        rl.on('line', function(line) {
            exec(`${line}`, (err, output) => {
                if (err) {
                  console.error("could not execute command: ", err);
                  return;
                }
                console.log(output)
            })
        }).on('close', () => {
            rl.close()
        })
    })
}

async function run(){
    try {
        let sys_result = await sys_cmd()
        console.log(sys_result)
    }
    catch (e) {
        console.log('Failed: ', e)
    }
}

if (process.argv.length === 3) {
  if (process.argv[2] === "--sync") {
    sync_counter();
  } else if (process.argv[2] === "--async") {
    async_counter();
  } else {
    throw new Error("Nieznany argument.");
  }
} else if (process.argv.length === 2) {
  run();
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#async_counter">async_counter</a></li><li><a href="global.html#requestListener">requestListener</a></li><li><a href="global.html#sync_counter">sync_counter</a></li><li><a href="global.html#sys_cmd">sys_cmd</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Wed Dec 20 2023 08:10:10 GMT+0100 (Central European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
